"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[9677,7892,8172,383],{57892:function(e,t,i){i.r(t),i.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"680px",visible:e.visible,"close-on-click-modal":!1,"custom-class":"ele-dialog-form",title:e.isUpdate?"修改支付码类型":"添加支付码类型"},on:{"update:visible":e.updateVisible}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[t("el-row",[t("el-form-item",{attrs:{label:"名称:",prop:"name"}},[t("el-input",{attrs:{clearable:"",maxlength:32,placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("el-row",[t("el-form-item",{attrs:{label:"代码:",prop:"code"}},[t("el-input",{attrs:{clearable:"",maxlength:20,placeholder:"请输入代码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消 ")]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("保存 ")])],1)],1)},l=[],n=(i(21703),i(29958));const s={id:null,name:"",code:""};var r={name:"AccountTypeEdit",props:{visible:Boolean,data:Object},data(){return{form:{...s},rules:{name:[{required:!0,trigger:"blur",validator:(e,t,i)=>{if(!t)return i(new Error("请输入名称"));n.pt({field:"name",value:this.data?.name,id:this.data?.id}).then((()=>{i(new Error("类型已经存在"))})).catch((()=>{i()}))}}],code:[{required:!0,trigger:"blur",validator:(e,t,i)=>{if(!t)return i(new Error("请输入代码"));n.pt({field:"code",value:this.data?.code,id:this.data?.id}).then((()=>{i(new Error("代码已经存在"))})).catch((()=>{i()}))}}]},loading:!1,isUpdate:!1}},methods:{save(){this.$refs["form"].validate((e=>{if(!e)return!1;this.loading=!0;const t={...this.form},i=this.isUpdate?n.pQ:n.Gw;i(t).then((()=>{this.loading=!1,this.$message.success("操作成功"),this.updateVisible(!1),this.$emit("done")})).catch((e=>{this.loading=!1,this.$message.error(e.message)}))}))},updateVisible(e){this.$emit("update:visible",e)}},watch:{visible(e){e?this.data?(this.$util.assignObject(this.form,{...this.data}),this.isUpdate=!0):this.isUpdate=!1:(this.$refs["form"].clearValidate(),this.form={...s})}}},o=r,c=i(1001),d=(0,c.Z)(o,a,l,!1,null,"15bb6734",null),u=d.exports},68172:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("el-form",{staticClass:"ele-form-search",attrs:{"label-width":"77px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},submit:function(e){e.preventDefault()}}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"用户账号:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.name,callback:function(t){e.$set(e.where,"name",t)},expression:"where.name"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("div",{staticClass:"ele-form-actions"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.search}},[e._v(" 查询 ")]),t("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)])],1)],1)},l=[];const n={username:"",realname:""};var s={name:"UserSearch",data(){return{where:{...n}}},methods:{search(){this.$emit("search",this.where)},reset(){this.where={...n},this.search()}}},r=s,o=i(1001),c=(0,o.Z)(r,a,l,!1,null,"6f6850f3",null),d=c.exports},10383:function(e,t,i){i.r(t),i.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"680px",visible:e.visible,"close-on-click-modal":!1,"custom-class":"ele-dialog-form",title:"添加通道"},on:{"update:visible":e.updateVisible}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"82px"}},[t("el-row",[t("el-form-item",{attrs:{label:"通道:",prop:"channel_id"}},[t("channel-select",{model:{value:e.form.channel_id,callback:function(t){e.$set(e.form,"channel_id",t)},expression:"form.channel_id"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消 ")]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("保存 ")])],1)],1)},l=[],n=i(29958);const s={account_type_id:"",channel_id:""};var r={name:"MerchantChannelEdit",props:{visible:Boolean,data:Object,channel:Object},data(){return{form:{...s},rules:{channel_id:[{required:!0,message:"请选择通道",trigger:"blur"}]},loading:!1,isUpdate:!1}},methods:{save(){this.$refs["form"].validate((e=>{if(!e)return!1;this.loading=!0;const t={...this.form};n.cq(t).then((()=>{this.loading=!1,this.$message.success("操作成功"),this.updateVisible(!1),this.$emit("done")})).catch((e=>{this.loading=!1,this.$message.error(e.message)}))}))},updateVisible(e){this.$emit("update:visible",e)}},watch:{visible(e){e?this.data?(this.$util.assignObject(this.form,{...this.data,account_type_id:this.data.id}),this.isUpdate=!0):this.isUpdate=!1:(this.$refs["form"].clearValidate(),this.form={...s})}}},o=r,c=i(1001),d=(0,c.Z)(o,a,l,!1,null,"bb505c0e",null),u=d.exports},59677:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("el-card",{attrs:{shadow:"never"}},[t("account-type-search",{on:{search:e.reload}}),t("ele-pro-table",{ref:"table",attrs:{columns:e.columns,datasource:e.datasource,selection:e.selection},on:{"update:selection":function(t){e.selection=t}},scopedSlots:e._u([{key:"channels",fn:function({row:i}){return[e._l(i.channels,(function(a){return t("el-tag",{key:a,attrs:{size:"mini",closable:"","disable-transitions":!1},on:{close:function(t){return e.removeChannel(i,a)}}},[e._v(" "+e._s(a.name)+" ")])})),t("el-tag",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.addChannel(i)}}},[e._v("+")])]}},{key:"action",fn:function({row:i}){return[t("el-button",{attrs:{type:"primary",underline:!1,icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.openEdit(i)}}},[e._v(" 修改 ")]),t("el-popconfirm",{staticClass:"ele-action",attrs:{title:"确定要删除此支付码类型吗？"},on:{confirm:function(t){return e.remove(i)}}},[t("el-button",{attrs:{slot:"reference",type:"danger",underline:!1,icon:"el-icon-delete",size:"mini"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])},[t("template",{slot:"toolbar"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openEdit()}}},[e._v(" 新建 ")])],1)],2)],1),t("account-type-edit",{attrs:{visible:e.showEdit,data:e.current},on:{"update:visible":function(t){e.showEdit=t},done:e.reload}}),t("channel-edit",{attrs:{visible:e.showChannelEdit,data:e.current},on:{"update:visible":function(t){e.showChannelEdit=t},done:e.reload}})],1)},l=[],n=i(68172),s=i(57892),r=i(10383),o=i(29958),c={name:"AdminChannelAccountType",components:{AccountTypeSearch:n["default"],AccountTypeEdit:s["default"],ChannelEdit:r["default"]},data(){return{columns:[{columnKey:"selection",type:"selection",width:45,align:"center"},{columnKey:"id",type:"index",width:45,align:"center",showOverflowTooltip:!0},{prop:"name",label:"类型名",sortable:"custom",showOverflowTooltip:!0,minWidth:60},{prop:"code",label:"代码",showOverflowTooltip:!0,minWidth:60},{prop:"channels",label:"关联通道",showOverflowTooltip:!1,minWidth:160,slot:"channels"},{prop:"accounts",label:"支付码数量",showOverflowTooltip:!0,minWidth:50},{columnKey:"action",label:"操作",width:260,align:"center",resizable:!1,slot:"action"}],selection:[],current:null,showEdit:!1,showChannelEdit:!1}},methods:{datasource({page:e,limit:t,where:i,order:a}){return o.II({...i,...a,page:e,limit:t})},reload(e){this.$refs.table.reload({page:1,where:e})},openEdit(e){this.current=e,this.showEdit=!0},addChannel(e){this.current=e,this.showChannelEdit=!0},removeChannel(e,t){const i=this.$loading({lock:!0});o.T6({account_type_id:e.id,channel_id:t.id}).then((()=>{i.close(),this.$message.success("操作成功"),this.reload()})).catch((e=>{i.close(),this.$message.error(e.message)}))},remove(e){const t=this.$loading({lock:!0});o.hX({id:e.id}).then((()=>{t.close(),this.$message.success("操作成功"),this.reload()})).catch((e=>{t.close(),this.$message.error(e.message)}))}}},d=c,u=i(1001),h=(0,u.Z)(d,a,l,!1,null,"89728752",null),m=h.exports}}]);