(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[8785,85,136],{90085:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return I}});var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"680px",visible:e.visible,"close-on-click-modal":!1,"custom-class":"ele-dialog-form",title:"确认订单"},on:{"update:visible":e.updateVisible}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"82px"}},[t("el-row",[t("el-form-item",{attrs:{label:"订单号:",prop:"daifu_id"}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.daifu_id,callback:function(t){e.$set(e.form,"daifu_id",t)},expression:"form.daifu_id"}})],1),t("el-form-item",{attrs:{label:"金额:",prop:"amount"}},[t("ele-text-primary",{staticStyle:{"font-size":"16px","margin-right":"12px"}},[e._v(" "+e._s(e.form.amount)+" ")]),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.form.amount,expression:"form.amount",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{icon:"el-icon-copy"}},[e._v("复制")])],1),t("el-form-item",{attrs:{label:"账号名:",prop:"account_name"}},[t("ele-text-primary",{staticStyle:{"font-size":"16px","margin-right":"12px"}},[e._v(" "+e._s(e.form.account_name)+" ")]),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.form.account_name,expression:"form.account_name",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{icon:"el-icon-copy"}},[e._v("复制")])],1),t("el-form-item",{attrs:{label:"账号:",prop:"account"}},[t("ele-text-primary",{staticStyle:{"font-size":"16px","margin-right":"12px"}},[e._v(" "+e._s(e.form.account)+" ")]),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.form.account,expression:"form.account",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{icon:"el-icon-copy"}},[e._v("复制")])],1),t("el-form-item",{attrs:{label:"开户行:",prop:"bank"}},[t("ele-text-primary",{staticStyle:{"font-size":"16px","margin-right":"12px"}},[e._v(" "+e._s(e.form.bank)+" ")]),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.form.bank,expression:"form.bank",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{icon:"el-icon-copy"}},[e._v("复制")])],1),t("el-form-item",{attrs:{label:"转账截图:",prop:"form.voucher"}},[t("el-row",[t("ele-image-upload",{attrs:{limit:1},on:{upload:e.onUpload},model:{value:e.imgs,callback:function(t){e.imgs=t},expression:"imgs"}})],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"warning",loading:e.loading},on:{click:e.cancelDaifu}},[e._v("撤单(让别人处理) ")]),t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消 ")]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("处理成功 ")])],1)],1)},r=[],o=i(95082),a=(i(73210),i(92222),i(21249),i(57327),i(41539),i(68309),i(23157),i(78783),i(33948),i(60285),i(41637),i(47941),i(9980)),s=i.n(a),l=i(92061),c=(i(26699),i(83647));function u(e,t,i,n,r,o,a,s){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}var d={name:"ImageItem",mixins:[c["default"]],props:{item:Object,disabled:Boolean,itemStyle:Object},emits:["remove","item-click","retry"],computed:{statusText:function(){return{uploading:this.t("ele.upload.uploading"),exception:this.t("ele.upload.exception")}[this.item.status]},progressVisible:function(){return!(!this.item.status||!["uploading","exception"].includes(this.item.status))}},methods:{onRemove:function(){this.$emit("remove")},onItemClick:function(){this.$emit("item-click")},onRetry:function(){this.$emit("retry")}}},m=function(){var e=this,t=e._self._c;return t("div",{class:["ele-image-upload-item",{draggable:!e.disabled}],style:e.itemStyle,on:{click:e.onItemClick}},[e.item.url?t("el-image",{attrs:{fit:"cover",width:"100%",height:"100%",src:e.item.url,title:e.item.name}}):[e._t("image",(function(){return[t("div",{staticClass:"ele-image-upload-thumbnail",attrs:{title:e.item.name}},[t("i",{staticClass:"el-icon-document"})])]}),{item:e.item})],e.disabled?e._e():t("div",{staticClass:"ele-image-upload-close",on:{click:function(t){return t.stopPropagation(),e.onRemove.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-close"})]),e.progressVisible?t("div",{staticClass:"ele-image-upload-progress"},[e._t("progress",(function(){return[t("div",{staticClass:"ele-image-upload-text"},[e._v(e._s(e.statusText))]),t("el-progress",{attrs:{"show-text":!1,percentage:e.item.progress,status:{exception:"exception"}[e.item.status]}}),"exception"===e.item.status?t("div",{staticClass:"ele-image-upload-retry"},[t("i",{staticClass:"el-icon-refresh",attrs:{title:e.t("ele.upload.retry")},on:{click:function(t){return t.stopPropagation(),e.onRetry.apply(null,arguments)}}})]):e._e()]}),{item:e.item})],2):t("div",{staticClass:"ele-image-upload-mask"})],2)},p=[],f=u(d,m,p,!1,null,null,null,null),h=f.exports,v=(i(9653),{value:{type:Array,required:!0},disabled:Boolean,preview:{type:Boolean,default:!0},itemStyle:Object,buttonStyle:Object,beforeUpload:Function,beforeRemove:Function,uploadHandler:Function,removeHandler:Function,autoUpload:{type:Boolean,default:!0},limit:Number,multiple:Boolean,drag:Boolean,accept:{type:String,default:"image/png,image/jpeg"}});function b(e,t,i,n,r,o,a,s){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}var g={name:"EleImageUpload",components:{VueDraggable:s(),ImageItem:h},mixins:[l.u],inject:{elForm:{default:null}},props:v,emits:["input","remove","item-click","upload"],data:function(){return{currentUrl:void 0}},computed:{isDisabled:function(){var e;return this.disabled||(null==(e=this.elForm)?void 0:e.disabled)},uploadVisible:function(){return!this.isDisabled&&!("number"===typeof this.limit&&this.limit>0&&this.value.length>=this.limit)},previewSrcList:function(){return this.preview?this.value.filter((function(e){return!!e.url})).map((function(e){return e.url})):null}},methods:{updateValue:function(e){this.$emit("input",e)},onUpload:function(e){var t=this;if(!this.authenticated)return console.warn(l.c),!1;if(!this.uploadVisible)return!1;if("function"===typeof this.uploadHandler)return this.uploadHandler(e),!1;var i={file:e,uid:e.uid,name:e.name,progress:0,status:void 0};return e.type.startsWith("image")&&(i.url=window.URL.createObjectURL(e)),"function"===typeof this.beforeUpload?Promise.resolve(this.beforeUpload(e)).then((function(e){!1!==e&&t.uploadItem(i)})).catch((function(e){e&&console.error(e)})):this.uploadItem(i),!1},uploadItem:function(e){this.updateValue(this.value.concat([e])),this.autoUpload&&this.$emit("upload",e)},onRemove:function(e){var t=this;"function"!==typeof this.removeHandler?"function"===typeof this.beforeRemove?Promise.resolve(this.beforeRemove(e)).then((function(i){!1!==i&&t.removeItem(e)})).catch((function(){})):this.removeItem(e):this.removeHandler(e)},removeItem:function(e){this.updateValue(this.value.filter((function(t){return t!==e}))),this.$emit("remove",e)},onItemClick:function(e){var t=this;this.preview&&e.url&&(this.currentUrl=e.url,this.$nextTick((function(){t.$refs.previewRef&&(t.$refs.previewRef.showViewer=!0)}))),this.$emit("item-click",e)},onRetry:function(e){this.$emit("upload",e)}},deactivated:function(){this.currentUrl=void 0}},_=function(){var e=this,t=e._self._c;return t("VueDraggable",{class:["ele-image-upload-list",{"ele-image-upload-disabled":e.isDisabled}],attrs:{value:e.value,animation:300,draggable:".draggable","set-data":function(){}},on:{input:e.updateValue},scopedSlots:e._u([{key:"footer",fn:function(){return[e.uploadVisible?t("div",{staticClass:"ele-image-upload-item ele-image-upload-button",style:[e.itemStyle,e.buttonStyle]},[t("el-upload",{attrs:{action:"",drag:e.drag,accept:e.accept,multiple:e.multiple,"show-file-list":!1,"before-upload":e.onUpload}},[e._t("icon",(function(){return[t("i",{staticClass:"el-icon-plus ele-image-upload-icon"})]}))],2)],1):e._e(),e.currentUrl?t("el-image",{ref:"previewRef",staticStyle:{display:"none"},attrs:{src:e.currentUrl,"preview-src-list":e.previewSrcList}}):e._e()]},proxy:!0}],null,!0)},e._l(e.value,(function(i){return t("ImageItem",{key:i.uid,attrs:{item:i,disabled:e.isDisabled,"item-style":e.itemStyle},on:{"item-click":function(t){return e.onItemClick(i)},remove:function(t){return e.onRemove(i)},retry:function(t){return e.onRetry(i)}},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),(function(t){return{key:t,fn:function(i){return[e._t(t,null,null,i||{})]}}}))],null,!0)})})),1)},y=[],w=b(g,_,y,!1,null,null,null,null),x=w.exports,k=i(29958),C={id:null,daifu_id:"",amount:0,account:"",account_name:"",bank:"",voucher:""},$={components:{EleImageUpload:x},name:"DaifuEdit",props:{visible:Boolean,data:Object},data:function(){return{form:(0,o.Z)({},C),rules:{name:[{required:!0}]},loading:!1,imgs:[]}},methods:{save:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;if(e.imgs.length<1)return!1;e.loading=!0;var i=(0,o.Z)((0,o.Z)({},e.form),{},{voucher:e.imgs[0].url});k.tK(i).then((function(){e.loading=!1,e.$message.success("操作成功"),e.updateVisible(!1),e.$emit("done")})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))}))},cancelDaifu:function(){var e=this;this.loading=!0;var t=(0,o.Z)({},this.form);k.il(t).then((function(){e.loading=!1,e.$message.success("操作成功"),e.updateVisible(!1),e.$emit("done")})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))},onUpload:function(e){console.log("item:",e),e.status="uploading",k.ws(e.file).then((function(t){e.status="done",e.url=t.url,e.fileUrl=t.url})).catch((function(t){e.status="exception",console.log(t)}))},updateVisible:function(e){this.$emit("update:visible",e)},onCopy:function(){this.$message.success("复制成功")},onError:function(){this.$message.error("复制失败")}},watch:{visible:function(e){e?this.data&&(this.$util.assignObject(this.form,(0,o.Z)({},this.data)),0==this.data.voucher.trim().length?this.imgs=[]:this.imgs=[{uid:1,url:this.data.voucher}]):(this.$refs["form"].clearValidate(),this.form=(0,o.Z)({},C))}}},S=$,E=i(1001),R=(0,E.Z)(S,n,r,!1,null,"19d5db45",null),I=R.exports},10136:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});i(74916),i(64765);var n=function(){var e=this,t=e._self._c;return t("el-form",{staticClass:"ele-form-search",attrs:{"label-width":"77px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},submit:function(e){e.preventDefault()}}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"订单号:",size:"mini"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.trade_id,callback:function(t){e.$set(e.where,"trade_id",t)},expression:"where.trade_id"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"商户:",size:"mini"}},[t("user-select",{attrs:{placeholder:"请选择","role-id":2},model:{value:e.where.merchant_id,callback:function(t){e.$set(e.where,"merchant_id",t)},expression:"where.merchant_id"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("div",{staticClass:"ele-form-actions"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v(" 查询 ")]),t("el-button",{attrs:{size:"mini"},on:{click:e.reset}},[e._v("重置")])],1)])],1)],1)},r=[],o=i(95082),a={trade_id:"",merchant_id:null},s={name:"AccountOwnerDaifuRealtimeSearch",data:function(){return{where:(0,o.Z)({},a)}},methods:{search:function(){this.$emit("search",this.where)},reset:function(){this.where=(0,o.Z)({},a),this.search()}}},l=s,c=i(1001),u=(0,c.Z)(l,n,r,!1,null,"59e78492",null),d=u.exports},78785:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return p}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("el-card",{attrs:{shadow:"never"}},[t("daifu-trade-search",{on:{search:e.reload}}),t("ele-pro-table",{ref:"table",attrs:{columns:e.columns,datasource:e.datasource,selection:e.selection},on:{"update:selection":function(t){e.selection=t}},scopedSlots:e._u([{key:"merchant",fn:function(t){var i,n=t.row;return[e._v(" "+e._s(null===(i=n.merchant)||void 0===i?void 0:i.username)+" ")]}},{key:"account",fn:function(i){var n=i.row;return["待接单"==n.receive_status?t("div",[e._v(" *** *** ")]):t("div",[e._v(" "+e._s(n.account_name)+" "),t("el-tag",{attrs:{size:"mini"}},[e._v(" "+e._s(n.bank)+" ")]),t("br"),e._v(" "+e._s(n.account)+" ")],1)]}},{key:"receive_status",fn:function(t){var i=t.row;return[e._v(" "+e._s(i.receive_status)+" ")]}},{key:"action",fn:function(i){var n=i.row;return["待接单"==n.receive_status?t("el-button",{attrs:{type:"primary",underline:!1,icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.jiedan(n)}}},[e._v(" 接单 ")]):e._e(),"待提交"==n.receive_status?t("el-button",{attrs:{type:"success",underline:!1,icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.openEdit(n)}}},[e._v(" 上传凭证 ")]):e._e()]}}])},[t("template",{slot:"toolbar"},[t("div",{staticClass:"list-tool-item"},[t("el-switch",{attrs:{size:"mini","active-text":"自动刷新"},model:{value:e.is_refresh,callback:function(t){e.is_refresh=t},expression:"is_refresh"}})],1)])],2)],1),t("daifu-edit",{attrs:{visible:e.showEdit,data:e.current},on:{"update:visible":function(t){e.showEdit=t},done:e.reload}})],1)},r=[],o=i(95082),a=i(10136),s=i(90085),l=i(29958),c={name:"AccountOwnerDaifuRealtime",components:{DaifuTradeSearch:a["default"],DaifuEdit:s["default"]},data:function(){var e=this;return{columns:[{columnKey:"selection",type:"selection",width:45,align:"center"},{prop:"id",type:"index",width:45,align:"center",showOverflowTooltip:!0},{prop:"daifu_id",label:"订单号",showOverflowTooltip:!0,minWidth:60},{prop:"amount",label:"金额",showOverflowTooltip:!0,minWidth:60},{prop:"account",label:"信息",showOverflowTooltip:!0,minWidth:120,slot:"account"},{prop:"created_at",label:"创建时间",sortable:"custom",showOverflowTooltip:!0,minWidth:60,formatter:function(t,i,n){return e.$util.toDateString(n,"MM-dd HH:mm:ss")}},{prop:"receive_status",label:"状态",align:"center",minWidth:40,resizable:!1,slot:"receive_status"},{columnKey:"action",label:"操作",align:"center",minWidth:40,resizable:!1,slot:"action"}],selection:[],showEdit:!1,current:null,is_refresh:!1,interval_id:null}},created:function(){this.interval_id=setInterval(this.time_refresh,3e3)},beforeDestroy:function(){console.log("before destroy"),this.interval_id&&clearInterval(this.interval_id)},methods:{time_refresh:function(){this.is_refresh&&this.reload()},datasource:function(e){var t=e.page,i=e.limit,n=e.where,r=e.order;return l.aW((0,o.Z)((0,o.Z)((0,o.Z)({},n),r),{},{page:t,limit:i}))},reload:function(e){this.$refs.table.reload({page:1,where:e})},openEdit:function(e){this.current=e,this.showEdit=!0},jiedan:function(e){var t=this;this.loading=!0,l.ye({id:e.id}).then((function(){t.loading=!1,t.reload(),t.$message.success("操作成功")})).catch((function(e){t.loading=!1,t.$message.error(e.message)}))}}},u=c,d=i(1001),m=(0,d.Z)(u,n,r,!1,null,"d3880b98",null),p=m.exports},81150:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},64765:function(e,t,i){"use strict";var n=i(46916),r=i(27007),o=i(19670),a=i(68554),s=i(84488),l=i(81150),c=i(41340),u=i(58173),d=i(97651);r("search",(function(e,t,i){return[function(t){var i=s(this),r=a(t)?void 0:u(t,e);return r?n(r,t,i):new RegExp(t)[e](c(i))},function(e){var n=o(this),r=c(e),a=i(t,n,r);if(a.done)return a.value;var s=n.lastIndex;l(s,0)||(n.lastIndex=0);var u=d(n,r);return l(n.lastIndex,s)||(n.lastIndex=s),null===u?-1:u.index}]}))}}]);