"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[6608,807],{80807:function(e,t,l){l.r(t),l.d(t,{default:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"720px",visible:e.visible,"close-on-click-modal":!1,"custom-class":"ele-dialog-form",title:e.isUpdate?"修改菜单":"添加菜单"},on:{"update:visible":e.updateVisible}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"92px"}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"上级菜单:"}},[t("ele-tree-select",{attrs:{clearable:"",data:e.menuList,"label-key":"title","value-key":"menuId","default-expand-all":"",placeholder:"请选择上级菜单"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1),t("el-form-item",{attrs:{label:"菜单名称:",prop:"title"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入菜单名称"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"菜单类型:"}},[t("el-radio-group",{on:{change:e.onMenuTypeChange},model:{value:e.form.menuType,callback:function(t){e.$set(e.form,"menuType",t)},expression:"form.menuType"}},[t("el-radio",{attrs:{label:0}},[e._v("菜单")]),t("el-radio",{attrs:{label:1}},[e._v("按钮")])],1)],1),t("el-form-item",{attrs:{label:"打开方式:"}},[t("el-radio-group",{attrs:{disabled:1===e.form.menuType},on:{change:e.onOpenTypeChange},model:{value:e.form.openType,callback:function(t){e.$set(e.form,"openType",t)},expression:"form.openType"}},[t("el-radio",{attrs:{label:0}},[e._v("组件")]),t("el-radio",{attrs:{label:1}},[e._v("内链")]),t("el-radio",{attrs:{label:2}},[e._v("外链")])],1)],1)],1)],1),t("div",{staticStyle:{margin:"6px 0 28px 0"}},[t("el-divider")],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"菜单图标:"}},[t("ele-icon-picker",{attrs:{placeholder:"请选择菜单图标",disabled:1===e.form.menuType},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),t("el-form-item",{attrs:{name:"path"}},[t("template",{slot:"label"},[2===e.form.openType?t("el-tooltip",{attrs:{placement:"top",content:"需要以`http://`、`https://`、`//`开头"}},[t("i",{staticClass:"el-icon-_question"})]):e._e(),t("span",[e._v(" "+e._s(2===e.form.openType?" 外链地址:":" 路由地址:")+" ")])],1),t("el-input",{attrs:{clearable:"",disabled:1===e.form.menuType,placeholder:e.pathPlaceholder},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],2),t("el-form-item",{attrs:{name:"component"}},[t("template",{slot:"label"},[1===e.form.openType?t("el-tooltip",{attrs:{placement:"top",content:"需要以`http://`、`https://`、`//`开头"}},[t("i",{staticClass:"el-icon-_question"})]):e._e(),t("span",[e._v(" "+e._s(1===e.form.openType?" 内链地址:":" 组件路径:")+" ")])],1),t("el-input",{attrs:{clearable:"",disabled:1===e.form.menuType||2===e.form.openType,placeholder:e.componentPlaceholder},model:{value:e.form.component,callback:function(t){e.$set(e.form,"component",t)},expression:"form.component"}})],2)],1),t("el-col",{attrs:{sm:12}},[t("el-form-item",{attrs:{label:"权限标识:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入权限标识",disabled:0===e.form.menuType},model:{value:e.form.authority,callback:function(t){e.$set(e.form,"authority",t)},expression:"form.authority"}})],1),t("el-form-item",{attrs:{label:"排序号:",prop:"sortNumber"}},[t("el-input-number",{staticClass:"ele-fluid ele-text-left",attrs:{min:0,placeholder:"请输入排序号","controls-position":"right"},model:{value:e.form.sortNumber,callback:function(t){e.$set(e.form,"sortNumber",t)},expression:"form.sortNumber"}})],1),t("el-form-item",{attrs:{label:"是否可见:"}},[t("el-switch",{attrs:{"active-value":0,"inactive-value":1,disabled:1===e.form.menuType},model:{value:e.form.hide,callback:function(t){e.$set(e.form,"hide",t)},expression:"form.hide"}}),t("el-tooltip",{attrs:{placement:"top",content:"选择不可见只注册路由不显示在侧边栏，比如添加页面应该选择不可见"}},[t("i",{staticClass:"el-icon-_question",staticStyle:{"vertical-align":"middle","margin-left":"8px"}})])],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v(" 保存 ")])],1)],1)},n=[],r=l(95082),a=(l(9653),l(23157),l(42680)),i=l(29958),s={menuId:null,parentId:"",title:"",menuType:0,openType:0,icon:"",path:"",component:"",authority:"",sortNumber:null,hide:0},c={name:"MenuEdit",components:{EleIconPicker:a.Z},props:{visible:Boolean,data:Object,parentId:Number,menuList:Array},data:function(){return{form:(0,r.Z)({},s),rules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],sortNumber:[{required:!0,message:"请输入排序号",trigger:"blur"}]},loading:!1,isUpdate:!1}},computed:{pathPlaceholder:function(){return 2===this.form.openType?"请输入外链地址":"请输入路由地址"},componentPlaceholder:function(){return 1===this.form.openType?"请输入内链地址":"请输入组件路径"}},methods:{save:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.loading=!0;var l=(0,r.Z)((0,r.Z)({},e.form),{},{parentId:e.form.parentId||0}),o=e.isUpdate?i.Q9:i.yx;o(l).then((function(t){e.loading=!1,e.$message.success(t),e.updateVisible(!1),e.$emit("done")})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))}))},updateVisible:function(e){this.$emit("update:visible",e)},onMenuTypeChange:function(){0===this.form.menuType?this.form.authority=null:(this.form.openType=0,this.form.icon=null,this.form.path=null,this.form.component=null,this.form.hide=0)},onOpenTypeChange:function(){2===this.form.openType&&(this.form.component=null)},isUrl:function(e){return!(!e||!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("//")))}},watch:{visible:function(e){if(e)if(this.data){var t,l=this.isUrl(this.data.component)?1:0;this.$util.assignObject(this.form,(0,r.Z)((0,r.Z)({},this.data),{},{openType:this.isUrl(this.data.path)?2:l,parentId:0===this.data.parentId?"":null!==(t=this.data.parentId)&&void 0!==t?t:""})),this.isUpdate=!0}else{var o;this.form.parentId=null!==(o=this.parentId)&&void 0!==o?o:"",this.isUpdate=!1}else this.$refs["form"].clearValidate(),this.form=(0,r.Z)({},s)}}},u=c,p=l(1001),m=(0,p.Z)(u,o,n,!1,null,"0c83d88c",null),d=m.exports},15732:function(e,t,l){l.r(t),l.d(t,{default:function(){return p}});l(74916),l(64765);var o=function(){var e=this,t=e._self._c;return t("el-form",{staticClass:"ele-form-search",attrs:{"label-width":"77px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},submit:function(e){e.preventDefault()}}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"菜单名称:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.title,callback:function(t){e.$set(e.where,"title",t)},expression:"where.title"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"菜单地址:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.path,callback:function(t){e.$set(e.where,"path",t)},expression:"where.path"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"权限标识:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.authority,callback:function(t){e.$set(e.where,"authority",t)},expression:"where.authority"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("div",{staticClass:"ele-form-actions"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v(" 查询 ")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)])],1)],1)},n=[],r=l(95082),a={title:"",path:"",authority:""},i={name:"MenuSearch",data:function(){return{where:(0,r.Z)({},a)}},methods:{search:function(){this.$emit("search",this.where)},reset:function(){this.where=(0,r.Z)({},a),this.search()}}},s=i,c=l(1001),u=(0,c.Z)(s,o,n,!1,null,"554a51b6",null),p=u.exports},6608:function(e,t,l){l.r(t),l.d(t,{default:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("el-card",{attrs:{shadow:"never"}},[t("menu-search",{on:{search:e.reload}}),t("ele-pro-table",{ref:"table",attrs:{"row-key":"menuId",columns:e.columns,datasource:e.datasource,"default-expand-all":"","need-page":!1,"parse-data":e.parseData},on:{done:e.onDone},scopedSlots:e._u([{key:"title",fn:function(l){var o=l.row;return[t("i",{class:o.icon}),e._v(" "+e._s(o.title)+" ")]}},{key:"menuType",fn:function(l){var o=l.row;return[e.isUrl(o.path)?t("el-tag",{attrs:{type:"warning",size:"mini","disable-transitions":!0}},[e._v(" 外链 ")]):e.isUrl(o.component)?t("el-tag",{attrs:{type:"success",size:"mini","disable-transitions":!0}},[e._v(" 内链 ")]):t("el-tag",{attrs:{type:["primary","info"][o.menuType],size:"mini","disable-transitions":!0}},[e._v(" "+e._s(["菜单","按钮"][o.menuType])+" ")])]}},{key:"action",fn:function(l){var o=l.row;return[t("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-plus"},on:{click:function(t){return e.openEdit(null,o.menuId)}}},[e._v(" 添加 ")]),t("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-edit"},on:{click:function(t){return e.openEdit(o)}}},[e._v(" 修改 ")]),t("el-popconfirm",{staticClass:"ele-action",attrs:{title:"确定要删除吗？"},on:{confirm:function(t){return e.remove(o)}}},[t("el-link",{attrs:{slot:"reference",type:"danger",underline:!1,icon:"el-icon-delete"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])},[t("template",{slot:"toolbar"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openEdit()}}},[e._v(" 添加 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small"},on:{click:e.expandAll}},[e._v(" 展开全部 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small"},on:{click:e.foldAll}},[e._v(" 折叠全部 ")])],1)],2)],1),t("menu-edit",{attrs:{data:e.current,"parent-id":e.parentId,"menu-list":e.menuList,visible:e.showEdit},on:{"update:visible":function(t){e.showEdit=t},done:e.reload}})],1)},n=[],r=l(95082),a=(l(23157),l(15732)),i=l(80807),s=l(29958),c={name:"SystemMenu",components:{MenuSearch:a["default"],MenuEdit:i["default"]},data:function(){var e=this;return{columns:[{columnKey:"index",type:"index",width:45,align:"center",showOverflowTooltip:!0,fixed:"left"},{prop:"title",label:"菜单名称",showOverflowTooltip:!0,minWidth:110,slot:"title"},{prop:"path",label:"路由地址",showOverflowTooltip:!0,minWidth:110},{prop:"component",label:"组件路径",showOverflowTooltip:!0,minWidth:110},{prop:"authority",label:"权限标识",showOverflowTooltip:!0,minWidth:110},{prop:"sortNumber",label:"排序",align:"center",showOverflowTooltip:!0,width:60},{prop:"hide",label:"可见",align:"center",showOverflowTooltip:!0,width:60,formatter:function(e,t,l){return["是","否"][l]}},{prop:"menuType",label:"类型",align:"center",showOverflowTooltip:!0,width:60,slot:"menuType"},{prop:"createTime",label:"创建时间",showOverflowTooltip:!0,minWidth:110,formatter:function(t,l,o){return e.$util.toDateString(o)}},{columnKey:"action",label:"操作",width:190,align:"center",resizable:!1,slot:"action"}],selection:[],current:null,showEdit:!1,menuList:[],parentId:null}},methods:{datasource:function(e){var t=e.where;return s.cW((0,r.Z)({},t))},parseData:function(e){return this.$util.toTreeData({data:e,idField:"menuId",parentIdField:"parentId"})},onDone:function(e){var t=e.data;this.menuList.length||(this.menuList=t)},reload:function(e){this.$refs.table.reload({where:e})},openEdit:function(e,t){this.current=e,this.parentId=t,this.showEdit=!0},remove:function(e){var t,l=this;if(null!==(t=e.children)&&void 0!==t&&t.length)this.$message.error("请先删除子节点");else{var o=this.$loading({lock:!0});s.Ls({id:e.menuId}).then((function(e){o.close(),l.$message.success(e),l.reload()})).catch((function(e){o.close(),l.$message.error(e.message)}))}},expandAll:function(){this.$refs.table.toggleRowExpansionAll(!0)},foldAll:function(){this.$refs.table.toggleRowExpansionAll(!1)},isUrl:function(e){return!(!e||!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("//")))}}},u=c,p=l(1001),m=(0,p.Z)(u,o,n,!1,null,"088fe9f4",null),d=m.exports}}]);