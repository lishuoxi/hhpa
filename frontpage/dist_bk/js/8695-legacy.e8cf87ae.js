"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[8695,9483,6058],{29483:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var o=function(){var e=this,t=e._self._c;return t("ele-modal",{attrs:{width:"420px",title:"绑定谷歌",visible:e.visible,"append-to-body":!0,"close-on-click-modal":!0},on:{"update:visible":e.updateVisible,closed:e.onClose},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("绑定")])]},proxy:!0}])},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"82px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"绑定谷歌"}},[t("ele-qr-code-svg",{attrs:{value:e.form.google_code_url,size:120}})],1),t("el-form-item",{attrs:{label:"谷歌码:",prop:"google_code"}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.google_code,callback:function(t){e.$set(e.form,"google_code",t)},expression:"form.google_code"}})],1),t("el-form-item",{attrs:{label:"验证码:",prop:"verify_code"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请输入验证码"},model:{value:e.form.verify_code,callback:function(t){e.$set(e.form,"verify_code",t)},expression:"form.verify_code"}})],1)],1)],1)},l=[],r=s(7877),i=s(38379),n=s(45623),a={props:{visible:Boolean},components:{EleQrCodeSvg:i.Z},data:function(){return{loading:!1,form:{google_code:"",google_code_url:"",verify_code:""},rules:{verify_code:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}}},created:function(){},watch:{visible:function(e,t){var s=this;console.log(t),e&&(this.loading=!0,(0,r.h8)(this.form).then((function(e){s.loading=!1,Object.assign(s.form,e,{})})).catch((function(e){s.loading=!1,s.$message.error(e.message)})))}},methods:{updateVisible:function(e){this.$emit("update:visible",e)},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,(0,r.q4)(e.form).then((function(){e.loading=!1,e.$message.success("绑定成功"),(0,n.kS)()})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))}))},onClose:function(){this.form={google_code:"",google_code_url:"",verify_code:""},this.$refs.form.resetFields(),this.loading=!1}}},c=a,d=s(1001),u=(0,d.Z)(c,o,l,!1,null,null,null),f=u.exports},28695:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("el-row",{attrs:{gutter:15}},[t("el-col",e._b({},"el-col",e.styleResponsive?{md:6,sm:8}:{span:6},!1),[t("el-card",{attrs:{shadow:"never","body-style":"padding: 25px;"}},[t("div",{staticClass:"user-info-card"},[t("div",{staticClass:"user-info-avatar-group"},[t("img",{staticClass:"user-info-avatar",attrs:{src:"/assets/avatar.jpg",alt:""}}),t("i",{staticClass:"el-icon-upload2"})]),t("h2",{staticClass:"user-info-name"},[e._v(e._s(e.loginUser.username))]),t("div",{staticClass:"user-info-desc"},[e._v(e._s(e.loginUser.username))])])])],1),t("el-col",e._b({},"el-col",e.styleResponsive?{md:18,sm:16}:{span:18},!1),[t("el-card",{attrs:{shadow:"never","body-style":"padding: 0;"}},[t("el-tabs",{staticClass:"user-info-tabs",model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[t("el-form",{ref:"form",staticStyle:{"max-width":"450px",padding:"34px 20px 0 20px"},attrs:{model:e.form,rules:e.rules,"label-width":"90px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save.apply(null,arguments)},submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"登陆账号:",prop:"username"}},[t("el-input",{attrs:{disabled:"",placeholder:"请输入登陆账号",clearable:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"真实名称:",prop:"realname"}},[t("el-input",{attrs:{placeholder:"请输入真实名称",clearable:""},model:{value:e.form.realname,callback:function(t){e.$set(e.form,"realname",t)},expression:"form.realname"}})],1),t("el-form-item",{attrs:{label:"后台登陆IP:"}},[t("el-input",{attrs:{placeholder:"请输入后台安全登陆IP,多个IP地址用逗号分割,为空则不限制",rows:4,type:"textarea"},model:{value:e.form.admin_secure_ips,callback:function(t){e.$set(e.form,"admin_secure_ips",t)},expression:"form.admin_secure_ips"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v(" 保存更改 ")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"账号安全",name:"account"}},[t("div",{staticClass:"user-account-list"},[t("div",{staticClass:"user-account-item ele-cell"},[t("div",{staticClass:"ele-cell-content"},[t("div",[e._v("支付密码")]),e.loginUser.secure_password_seted?t("div",{staticClass:"ele-text-secondary"},[e._v(" 已设置 ")]):e._e(),e.loginUser.secure_password_seted?e._e():t("div",{staticClass:"ele-text-secondary",staticStyle:{color:"red"}},[e._v(" 未设置 ")])]),e.loginUser.secure_password_seted?t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){e.securePwdVisible=!0}}},[e._v("去设置")]):e._e(),e.loginUser.secure_password_seted?e._e():t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){e.securePwdVisible=!0}}},[e._v("去修改")])],1),t("el-divider"),t("div",{staticClass:"user-account-item ele-cell"},[t("div",{staticClass:"ele-cell-content"},[t("div",[e._v("谷歌验证码")]),e.loginUser.google_seted?t("div",{staticClass:"ele-text-secondary"},[e._v(" 已绑定 ")]):e._e(),e.loginUser.google_seted?e._e():t("div",{staticClass:"ele-text-secondary",staticStyle:{color:"red"}},[e._v(" 未绑定 ")])]),e.loginUser.google_seted?t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){e.googleAuthVisible=!0}}},[e._v(" 修改绑定")]):e._e(),e.loginUser.google_seted?e._e():t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){e.googleAuthVisible=!0}}},[e._v(" 去绑定")])],1),t("el-divider")],1)])],1)],1)],1)],1),t("google-auth-modal",{attrs:{visible:e.googleAuthVisible},on:{"update:visible":function(t){e.googleAuthVisible=t}}}),t("secure-pwd-modal",{attrs:{visible:e.securePwdVisible},on:{"update:visible":function(t){e.securePwdVisible=t}}})],1)},l=[],r=s(95082),i=s(29483),n=s(96058),a=s(7877),c={name:"UserProfile",components:{GoogleAuthModal:i["default"],SecurePwdModal:n["default"]},data:function(){return{active:"info",form:{username:"",realname:"1",admin_secure_ips:""},rules:{username:[{required:!0,message:"请输入昵称",trigger:"blur"}],realname:[{required:!0,message:"请输入真实名称",trigger:"blur"}]},loading:!1,visible:!1,googleAuthVisible:!1,securePwdVisible:!1}},computed:{loginUser:function(){return this.$store.state.user.info},styleResponsive:function(){return this.$store.state.theme.styleResponsive}},created:function(){Object.assign(this.form,this.loginUser,{}),console.log("this.form"),console.log(this.form)},methods:{save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,a.gS(e.form).then((function(){e.loading=!1,e.$message.success("操作成功"),e.updateLoginUser(e.form)})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))}))},updateLoginUser:function(e){this.$store.dispatch("user/setInfo",(0,r.Z)((0,r.Z)({},this.loginUser),e))}}},d=c,u=s(1001),f=(0,u.Z)(d,o,l,!1,null,"30afa20c",null),m=f.exports},96058:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("ele-modal",{attrs:{width:"420px",title:"设置支付密码",visible:e.visible,"append-to-body":!0,"close-on-click-modal":!0},on:{"update:visible":e.updateVisible,closed:e.onClose},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("绑定")])]},proxy:!0}])},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"原支付密码"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请输入原支付密码"},model:{value:e.form.old_pwd,callback:function(t){e.$set(e.form,"old_pwd",t)},expression:"form.old_pwd"}})],1),t("el-form-item",{attrs:{label:"新支付密码:",prop:"google_code"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请输入新支付密码"},model:{value:e.form.new_pwd,callback:function(t){e.$set(e.form,"new_pwd",t)},expression:"form.new_pwd"}})],1),t("el-form-item",{attrs:{label:"验证码:",prop:"verify_code"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请确认新支付密码"},model:{value:e.form.new_pwd_confirm,callback:function(t){e.$set(e.form,"new_pwd_confirm",t)},expression:"form.new_pwd_confirm"}})],1)],1)],1)},l=[],r=s(7877),i={props:{visible:Boolean},data:function(){return{loading:!1,form:{old_pwd:"",new_pwd:"",new_pwd_confirm:""},rules:{new_pwd:[{required:!0,message:"请输入新支付密码",trigger:"blur"}],new_pwd_confirm:[{required:!0,message:"请确认新支付密码",trigger:"blur"}]}}},created:function(){},methods:{updateVisible:function(e){this.$emit("update:visible",e)},save:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,(0,r.O5)(e.form).then((function(){e.loading=!1,e.$message.success("设置成功"),(0,r.gS)(e.form).then((function(){e.loading=!1,e.$message.success("操作成功"),e.updateLoginUser(e.form)})).catch((function(t){e.loading=!1,e.$message.error(t.message)})),e.updateVisible(!1)})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))}))},onClose:function(){this.form={old_pwd:"",new_pwd:"",new_pwd_confirm:""},this.$refs.form.resetFields(),this.loading=!1}}},n=i,a=s(1001),c=(0,a.Z)(n,o,l,!1,null,null,null),d=c.exports}}]);